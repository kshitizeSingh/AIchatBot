"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@react-native-async-storage/async-storage"),t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var n={exports:{}};var s,i={exports:{}};function o(){return s||(s=1,i.exports=(e=e||function(e,r){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==t&&t.crypto&&(n=t.crypto),!n)try{n=require("crypto")}catch(e){}var s=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},i=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),o={},a=o.lib={},c=a.Base={extend:function(e){var t=i(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=a.WordArray=c.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=t!=r?t:4*e.length},toString:function(e){return(e||f).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,s=e.sigBytes;if(this.clamp(),n%4)for(var i=0;i<s;i++){var o=r[i>>>2]>>>24-i%4*8&255;t[n+i>>>2]|=o<<24-(n+i)%4*8}else for(var a=0;a<s;a+=4)t[n+a>>>2]=r[a>>>2];return this.sigBytes+=s,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(s());return new u.init(t,e)}}),h=o.enc={},f=h.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],s=0;s<r;s++){var i=t[s>>>2]>>>24-s%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new u.init(r,t/2)}},p=h.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],s=0;s<r;s++){var i=t[s>>>2]>>>24-s%4*8&255;n.push(String.fromCharCode(i))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new u.init(r,t)}},l=h.Utf8={stringify:function(e){try{return decodeURIComponent(escape(p.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return p.parse(unescape(encodeURIComponent(e)))}},d=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r,n=this._data,s=n.words,i=n.sigBytes,o=this.blockSize,a=i/(4*o),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*o,h=e.min(4*c,i);if(c){for(var f=0;f<c;f+=o)this._doProcessBlock(s,f);r=s.splice(0,c),n.sigBytes-=h}return new u.init(r,h)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});a.Hasher=d.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new y.HMAC.init(e,r).finalize(t)}}});var y=o.algo={};return o}(Math),e)),i.exports;var e}var a,c={exports:{}};function u(){return a?c.exports:(a=1,c.exports=(e=o(),function(t){var r=e,n=r.lib,s=n.WordArray,i=n.Hasher,o=r.algo,a=[],c=[];!function(){function e(e){for(var r=t.sqrt(e),n=2;n<=r;n++)if(!(e%n))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var n=2,s=0;s<64;)e(n)&&(s<8&&(a[s]=r(t.pow(n,.5))),c[s]=r(t.pow(n,1/3)),s++),n++}();var u=[],h=o.SHA256=i.extend({_doReset:function(){this._hash=new s.init(a.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],s=r[1],i=r[2],o=r[3],a=r[4],h=r[5],f=r[6],p=r[7],l=0;l<64;l++){if(l<16)u[l]=0|e[t+l];else{var d=u[l-15],y=(d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3,g=u[l-2],v=(g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10;u[l]=y+u[l-7]+v+u[l-16]}var w=n&s^n&i^s&i,m=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),_=p+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&h^~a&f)+c[l]+u[l];p=f,f=h,h=a,a=o+_|0,o=i,i=s,s=n,n=_+(m+w)|0}r[0]=r[0]+n|0,r[1]=r[1]+s|0,r[2]=r[2]+i|0,r[3]=r[3]+o|0,r[4]=r[4]+a|0,r[5]=r[5]+h|0,r[6]=r[6]+f|0,r[7]=r[7]+p|0},_doFinalize:function(){var e=this._data,r=e.words,n=8*this._nDataBytes,s=8*e.sigBytes;return r[s>>>5]|=128<<24-s%32,r[14+(s+64>>>9<<4)]=t.floor(n/4294967296),r[15+(s+64>>>9<<4)]=n,e.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});r.SHA256=i._createHelper(h),r.HmacSHA256=i._createHmacHelper(h)}(Math),e.SHA256));var e}var h,f,p,l,d,y={exports:{}};var g=r(n.exports=function(e){return e.HmacSHA256}(o(),u(),h||(h=1,y.exports=(f=o(),l=(p=f).lib.Base,d=p.enc.Utf8,void(p.algo.HMAC=l.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=d.parse(t));var r=e.blockSize,n=4*r;t.sigBytes>n&&(t=e.finalize(t)),t.clamp();for(var s=this._oKey=t.clone(),i=this._iKey=t.clone(),o=s.words,a=i.words,c=0;c<r;c++)o[c]^=1549556828,a[c]^=909522486;s.sigBytes=i.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,r=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(r))}})))))),v={exports:{}};v.exports=function(e){return function(){var t=e,r=t.lib.WordArray;function n(e,t,n){for(var s=[],i=0,o=0;o<t;o++)if(o%4){var a=n[e.charCodeAt(o-1)]<<o%4*2|n[e.charCodeAt(o)]>>>6-o%4*2;s[i>>>2]|=a<<24-i%4*8,i++}return r.create(s,i)}t.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp();for(var s=[],i=0;i<r;i+=3)for(var o=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,a=0;a<4&&i+.75*a<r;a++)s.push(n.charAt(o>>>6*(3-a)&63));var c=n.charAt(64);if(c)for(;s.length%4;)s.push(c);return s.join("")},parse:function(e){var t=e.length,r=this._map,s=this._reverseMap;if(!s){s=this._reverseMap=[];for(var i=0;i<r.length;i++)s[r.charCodeAt(i)]=i}var o=r.charAt(64);if(o){var a=e.indexOf(o);-1!==a&&(t=a)}return n(e,t,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64}(o());var w=r(v.exports);class m{constructor(e){this.config=e}generateHMAC(e,t,r=null){const n=Date.now(),s=`${e}|${t}|${n}|${r?JSON.stringify(r):""}`;return{timestamp:n,signature:w.stringify(g(s,this.config.clientSecret))}}async request(t,r,n=null){const{timestamp:s,signature:i}=this.generateHMAC(t,r,n),o=await e.getItem("access_token"),a={"Content-Type":"application/json","X-Client-ID":this.config.clientId,"X-Timestamp":s.toString(),"X-Signature":i};o&&(a.Authorization=`Bearer ${o}`);const c={method:t,headers:a};n&&(c.body=JSON.stringify(n));try{const e=await fetch(`${this.config.apiBaseUrl}${r}`,c);if(!e.ok){const t=await e.json();throw new Error(t.error||"Request failed")}return await e.json()}catch(e){throw this.config.debug&&console.error("API Request Error:",e),e}}async login(t,r){const n=await this.request("POST","/v1/auth/login",{email:t,password:r});return await e.setItem("access_token",n.access_token),await e.setItem("refresh_token",n.refresh_token),n}async signup(e,t,r){return this.request("POST","/v1/auth/signup",{email:e,password:t,org_id:r})}async refreshToken(){const t=await e.getItem("refresh_token");if(!t)throw new Error("No refresh token available");const r=await this.request("POST","/v1/auth/refresh",{refresh_token:t});return await e.setItem("access_token",r.access_token),await e.setItem("refresh_token",r.refresh_token),r}async uploadDocument(e,t){return this.request("POST","/v1/documents/upload",{filename:e,content_type:t})}async getDocuments(){return this.request("GET","/v1/documents")}async getDocumentStatus(e){return this.request("GET",`/v1/documents/${e}/status`)}async sendMessage(e,t){return this.request("POST","/v1/chat/query",{query:e,conversation_id:t})}async getConversations(){return this.request("GET","/v1/chat/conversations")}async getConversationHistory(e){return this.request("GET",`/v1/chat/history/${e}`)}async getUsers(){return this.request("GET","/v1/users")}async promoteUserToAdmin(e){return this.request("POST","/v1/convert-user-to-admin",{user_id:e})}async revokeUserAccess(e){return this.request("POST","/v1/revoke-access",{user_id:e})}}class _{constructor(e){this.apiService=e}async login(e,t){return this.apiService.login(e,t)}async signup(e,t,r){return this.apiService.signup(e,t,r)}async refreshToken(){return this.apiService.refreshToken()}async logout(){try{await this.clearStoredTokens()}catch(e){console.warn("Error during logout:",e)}}async isAuthenticated(){try{return!!await this.getStoredAccessToken()}catch(e){return!1}}async getStoredAccessToken(){return require("@react-native-async-storage/async-storage").getItem("access_token")}async getStoredRefreshToken(){return require("@react-native-async-storage/async-storage").getItem("refresh_token")}async clearStoredTokens(){const e=require("@react-native-async-storage/async-storage");await e.removeItem("access_token"),await e.removeItem("refresh_token")}}class S{constructor(e){this.apiService=new m(e),this.authService=new _(this.apiService)}async login(e,t){return this.authService.login(e,t)}async signup(e,t,r){return this.authService.signup(e,t,r)}async refreshToken(){return this.authService.refreshToken()}async logout(){return this.authService.logout()}async isAuthenticated(){return this.authService.isAuthenticated()}async uploadDocument(e,t){return this.apiService.uploadDocument(e,t)}async getDocuments(){return this.apiService.getDocuments()}async getDocumentStatus(e){return this.apiService.getDocumentStatus(e)}async sendMessage(e,t){return this.apiService.sendMessage(e,t)}async getConversations(){return this.apiService.getConversations()}async getConversationHistory(e){return this.apiService.getConversationHistory(e)}async getUsers(){return this.apiService.getUsers()}async promoteUserToAdmin(e){return this.apiService.promoteUserToAdmin(e)}async revokeUserAccess(e){return this.apiService.revokeUserAccess(e)}}exports.AIFAQSDK=S,exports.createAIFAQSDK=function(e){return new S(e)},exports.default=S;
//# sourceMappingURL=index.js.map
